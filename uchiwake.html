<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>見積内訳</title>
</head>
<body>
  <h1>御見積内訳書</h1>
  <table border="1">
    <tbody id="estimateTable"></tbody>
  </table>
  <button onclick="window.print()">PDFとして保存</button>

  <script>
    const params = new URLSearchParams(window.location.search);
    const structure = params.get("structure") || "";
    const area = parseFloat(params.get("area") || 0);
    const scaffold = parseFloat(params.get("scaffold") || 0);
    const unitPrices = {
      "木造": 33000 / 3.3,
      "RC造": 50000 / 3.3,
      "S造": 33000 / 3.3,
      "軽量鉄骨造": 33000 / 3.3
    };

    const wastePrices = {
      wood: 16, board: 35, plastic: 50, rubble: 2, glass: 10, ceramic: 20
    };

    const wasteAmounts = {
      wood: parseFloat(params.get("woodWaste") || 0),
      board: parseFloat(params.get("boardWaste") || 0),
      plastic: parseFloat(params.get("plasticWaste") || 0),
      rubble: parseFloat(params.get("rubbleWaste") || 0),
      glass: parseFloat(params.get("glassWaste") || 0),
      ceramic: parseFloat(params.get("ceramicWaste") || 0)
    };

    const demolitionCost = Math.round(area * unitPrices[structure]);
    const scaffoldCost = Math.round(scaffold * 600);
    const asbestosSurvey = 90000;
    const totalWasteCost = Object.keys(wastePrices).reduce((sum, key) => {
      return sum + (wastePrices[key] * (wasteAmounts[key] || 0));
    }, 0);

    const total = demolitionCost + scaffoldCost + asbestosSurvey + totalWasteCost;

    const table = document.getElementById("estimateTable");
    table.innerHTML = `
      <tr><td>解体工事費 (${structure})</td><td>${demolitionCost.toLocaleString()} 円</td></tr>
      <tr><td>足場費</td><td>${scaffoldCost.toLocaleString()} 円</td></tr>
      <tr><td>アスベスト調査費</td><td>${asbestosSurvey.toLocaleString()} 円</td></tr>
      <tr><td>産廃処分費</td><td>${totalWasteCost.toLocaleString()} 円</td></tr>
      <tr><th>合計</th><th>${total.toLocaleString()} 円</th></tr>
    `;
  </script>
</body>
</html>