<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MiTAS 見積内訳</title>
</head>
<body>
  <h1>見積内訳</h1>
  <div id="summary"></div>

  <script src="settings.js"></script>
  <script>
    function getParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    function formatNumber(n) {
      return Number(n).toLocaleString();
    }

    // 入力値の取得
    const structure = getParam("structure");
    const area = parseFloat(getParam("area") || 0);
    const scaffold = parseFloat(getParam("scaffold") || 0);
    const wood = parseFloat(getParam("woodWaste") || 0);
    const board = parseFloat(getParam("boardWaste") || 0);
    const plastic = parseFloat(getParam("plasticWaste") || 0);
    const rubble = parseFloat(getParam("rubbleWaste") || 0);
    const glass = parseFloat(getParam("glassWaste") || 0);
    const ceramic = parseFloat(getParam("ceramicWaste") || 0);

    // 単価の取得
    const demolitionUnit = UNIT_PRICES.demolition[structure] || 0;
    const scaffoldUnit = UNIT_PRICES.scaffold;
    const asbestosSurvey = UNIT_PRICES.asbestosSurvey;
    const machineTransport = UNIT_PRICES.machineTransport.under10km;
    const waste = UNIT_PRICES.waste;

    // 金額の計算
    const demolitionCost = Math.round(area * (demolitionUnit / 3.3));
    const scaffoldCost = Math.round(scaffold * scaffoldUnit);
    const woodCost = Math.round(wood * waste["木くず"]);
    const boardCost = Math.round(board * waste["ボード類"]);
    const plasticCost = Math.round(plastic * waste["廃プラ類"]);
    const rubbleCost = Math.round(rubble * waste["ガラ"]);
    const glassCost = Math.round(glass * waste["ガラス"]);
    const ceramicCost = Math.round(ceramic * waste["陶器"]);
    const totalCost = demolitionCost + scaffoldCost + asbestosSurvey + machineTransport +
                      woodCost + boardCost + plasticCost + rubbleCost + glassCost + ceramicCost;

    // 表示
    document.getElementById("summary").innerHTML = `
      <p>建物構造：${structure}</p>
      <p>延床面積：${area} ㎡</p>
      <p>解体工事費：¥${formatNumber(demolitionCost)}</p>
      <p>足場費：¥${formatNumber(scaffoldCost)}</p>
      <p>アスベスト調査費：¥${formatNumber(asbestosSurvey)}</p>
      <p>重機回送費：¥${formatNumber(machineTransport)}</p>
      <p>木くず処分費：¥${formatNumber(woodCost)}</p>
      <p>ボード類処分費：¥${formatNumber(boardCost)}</p>
      <p>廃プラ処分費：¥${formatNumber(plasticCost)}</p>
      <p>ガラ処分費：¥${formatNumber(rubbleCost)}</p>
      <p>ガラス処分費：¥${formatNumber(glassCost)}</p>
      <p>陶器処分費：¥${formatNumber(ceramicCost)}</p>
      <h3>合計金額：¥${formatNumber(totalCost)}</h3>
    `;
  </script>
</body>
</html>