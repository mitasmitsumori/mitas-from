function calculateEstimate(data, settings) {
  const prices = settings.unitPrices;
  const rows = [];
  const pushRow = (label, qty, unit, unitKey) => {
    const unitPrice = prices[unitKey] || 0;
    const amount = Math.round(qty * unitPrice);
    rows.push([label, qty, unit, unitPrice, amount]);
  };
  pushRow("解体工事費", data.area, "㎡", data.structure);
  pushRow("足場工事費", data.scaffold, "㎡", "足場");
  pushRow("木くず（処分費）", data.woodWaste, "kg", "木くず");
  pushRow("ボード類", data.boardWaste, "kg", "ボード類");
  pushRow("廃プラ類", data.plasticWaste, "kg", "廃プラ類");
  pushRow("ガラ", data.rubbleWaste, "kg", "ガラ");
  pushRow("ガラス", data.glassWaste, "kg", "ガラス");
  pushRow("陶器", data.ceramicWaste, "kg", "陶器");
  return { rows };
}